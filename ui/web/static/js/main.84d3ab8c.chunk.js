(this["webpackJsonpcayley-ui"]=this["webpackJsonpcayley-ui"]||[]).push([[0],{39:function(e,t,n){e.exports=n.p+"static/media/logo.ca711468.svg"},47:function(e,t,n){e.exports=n(84)},52:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),l=n.n(c),u=(n(52),n(4)),o=n(21),i=n(15),s=n(40),f=(n(53),n(101)),m=n(102),d=(n(54),n(55),n(56),n(57),n(9)),p=n.n(d),v=n(12),b=n(10),O=n.n(b),g=[{label:"Gizmo",value:"gizmo"},{label:"GraphQL",value:"graphql"},{label:"MQL",value:"mql"}];function y(e,t,n){return h.apply(this,arguments)}function h(){return(h=Object(v.a)(p.a.mark(function e(t,n,a){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t,"/api/v2/query?").concat(new URLSearchParams({lang:n})),{method:"POST",headers:{Accept:"application/ld+json"},body:a});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var E=n(24),j=(n(32),n(26)),w=(n(33),n(14)),k=(n(34),function(e){var t=e.onClick;return r.a.createElement(w.a,{icon:"play_circle_filled",unelevated:!0,label:"Run",onClick:t})}),x=function(){var e=a.useState(),t=Object(u.a)(e,2),n=t[0],r=t[1];return[a.useCallback(function(e,t){r(t)},[r]),n]},C=g[0].value,S="LAST_QUERY";var P={text:"g.V().all()",language:C},R=function(){var e=localStorage.getItem(S);return e?JSON.parse(e):null}()||P;function L(){return R}function q(e){R=e,function(e){localStorage.setItem(S,JSON.stringify(e))}(e)}var D=function(e){switch(e){case"gizmo":return"javascript";case"graphql":return"graphql";case"mql":return"json";default:throw new Error("Unexpected value ".concat(e))}},N=function(){var e=Object(v.a)(p.a.mark(function e(){var t,n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("","/gizmo.d.ts"),e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.text();case 6:return a=e.sent,e.abrupt("return",[a,t]);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function U(){return(U=Object(v.a)(p.a.mark(function e(t,n){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,b.monaco.init();case 4:a=e.sent,t.addAction({id:"cayley-run",label:"Run",keybindings:[a.KeyMod.CtrlCmd|a.KeyCode.Enter],run:function(){n()}});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Q={minimap:{enabled:!1}};function T(){return(T=Object(v.a)(p.a.mark(function e(){var t,n,a,r,c,l,o,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return t=e.sent,n=Object(u.a)(t,2),a=n[0],r=n[1],e.next=8,b.monaco.init();case 8:c=e.sent,l=c.languages.typescript,o=l.javascriptDefaults,i=l.ScriptTarget,o.setCompilerOptions({noLib:!0,target:i.ES5,allowNonTsExtensions:!0}),o.addExtraLib(a,r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){T.apply(this,arguments)}();var z=function(e){var t=e.onRun,n=L(),c=x(),l=Object(u.a)(c,2),o=l[0],i=l[1],s=Object(a.useState)(n.language),f=Object(u.a)(s,2),m=f[0],d=f[1];Object(a.useEffect)(function(){var e=L();d(e.language)},[d]);var p=Object(a.useCallback)(function(e,t){var n=L();t.setValue(n.text),o(e,t)},[o]),v=r.a.useCallback(function(e){d(e.target.value)},[d]),b=Object(a.useCallback)(function(){i&&t(i.getValue(),m)},[i,m,t]);return Object(a.useEffect)(function(){i&&function(e,t){U.apply(this,arguments)}(i,b)},[i,b]),Object(a.useEffect)(function(){return i&&i.onDidChangeModelContent(function(){q({text:i.getValue(),language:m})}),function(){i&&q({text:i.getValue(),language:m})}},[i,m]),r.a.createElement("div",{className:"QueryEditor"},r.a.createElement(E.a,{use:"headline6"},"Query Editor"),r.a.createElement(O.a,{height:300,editorDidMount:p,language:D(m),options:Q}),r.a.createElement("div",{className:"actions"},r.a.createElement(k,{onClick:b}),r.a.createElement(j.a,{outlined:!0,options:g,value:m,onChange:v})))},V={readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1},A=function(e){var t=e.value;return r.a.createElement(O.a,{height:300,value:t?JSON.stringify(t,null,4):"",language:"json",options:V})},W=n(103),J=n(99),M=(n(35),n(5)),_=(n(79),n(80),function(e){var t=e.queries;return r.a.createElement(W.a,{className:"QueryHistory"},Object(i.a)(t).reverse().map(function(e){var t=g.find(function(t){return t.value===e.language});return r.a.createElement(J.d,{key:e.id},r.a.createElement("div",{className:"time"},e.time.toLocaleString()),r.a.createElement("div",{className:"status"},e.result?"error"in e.result?r.a.createElement(M.a,{icon:"error"}):r.a.createElement(M.a,{icon:"check_circle"}):null),r.a.createElement("div",{className:"language"},t&&t.label),r.a.createElement("div",{className:"query"},e.text))}))});function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var B=null,F=[];var G=function(e){var t=e.serverURL,n=Object(a.useState)(0),c=Object(u.a)(n,2),l=c[0],d=c[1],p=Object(a.useState)(B),v=Object(u.a)(p,2),b=v[0],O=v[1],g=Object(a.useState)(F),h=Object(u.a)(g,2),E=h[0],j=h[1],w=r.a.useCallback(function(e,n){var a=E.length;O(a),j(function(t){return[].concat(Object(i.a)(t),[{id:a,text:e,result:null,language:n,time:new Date}])}),y(t,n,e).then(function(e){j(function(t){return t.map(function(t){return t.id===a?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(n,!0).forEach(function(t){Object(o.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{result:e}):t})})}).catch(function(e){alert(e)})},[E,t]),k=E.find(function(e){return e.id===b}),x=k?k.result:null;return r.a.createElement("main",null,r.a.createElement(z,{onRun:w}),r.a.createElement(s.a,null,r.a.createElement(f.a,{style:{width:"30em"},activeTabIndex:l,onActivate:function(e){return d(e.detail.index)}},r.a.createElement(m.a,null,"Results"),r.a.createElement(m.a,null,"Query History")),0===l&&r.a.createElement(A,{value:x}),1===l&&r.a.createElement(_,{queries:E})))},H=n(41);function K(){return(K=Object(v.a)(p.a.mark(function e(t,n,a){var r,c,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t,"/api/v1/shape/").concat(n),{method:"POST",body:a});case 2:return r=e.sent,e.next=5,r.json();case 5:if(c=e.sent,l=c.error,u=Object(H.a)(c,["error"]),!l){e.next=10;break}throw new Error(l);case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Y=function(e){var t=e.serverURL,n=Object(a.useState)(null),c=Object(u.a)(n,2),l=c[0],o=c[1],i=Object(a.useCallback)(function(e,n){(function(e,t,n){return K.apply(this,arguments)})(t,n,e).then(o)},[t]);return r.a.createElement("main",null,r.a.createElement(z,{onRun:i}),r.a.createElement(A,{value:l}))},$=n(42),X=n(38),Z=n(17);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var te={nodes:[],links:[]},ne=function(e){var t=e.data,n=e.linkComponent,c=e.nodeComponent,l=Object(a.useState)(te),i=Object(u.a)(l,2),s=i[0],f=i[1],m=Object(X.a)(),d=Object(u.a)(m,2),p=d[0],v=d[1],b=v.width,O=v.height;return Object(a.useEffect)(function(){t&&b&&O&&Object(Z.d)(t.nodes).force("link",Object(Z.b)().id(function(e){return e.id}).links(t.links).distance(100)).force("charge",Object(Z.c)()).force("center",Object(Z.a)(b/2,O/2)).on("tick",function(){f(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(n,!0).forEach(function(t){Object(o.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t))})},[t,O,b]),r.a.createElement("div",{className:"graph",ref:p},r.a.createElement("svg",null,r.a.createElement($.a,{graph:s,linkComponent:n,nodeComponent:c})))},ae=(n(81),function(e){var t=[],n=new Set,a=!0,r=!1,c=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var o=l.value;if("source"in o&&"target"in o){var s=o.source["@id"],f=o.target["@id"];n.add(s),n.add(f),t.push({source:s,target:f})}}}catch(m){r=!0,c=m}finally{try{a||null==u.return||u.return()}finally{if(r)throw c}}return{links:t,nodes:Object(i.a)(n.values()).map(function(e){return{id:e}})}}),re=function(e){var t=e.link;return r.a.createElement("line",{x1:t.source.x,y1:t.source.y,x2:t.target.x,y2:t.target.y,strokeWidth:2,stroke:"#999",strokeOpacity:.6},r.a.createElement("text",null,t.id))},ce=function(e){var t=e.node;return r.a.createElement("g",null,r.a.createElement("circle",{r:5,fill:"#21D4FD"}),r.a.createElement("text",{textAnchor:"end"},t.id))},le=function(e){var t=e.serverURL,n=Object(a.useState)(null),c=Object(u.a)(n,2),l=c[0],o=c[1],i=Object(a.useCallback)(function(e,n){y(t,n,e).then(function(e){o(e)})},[t]);return r.a.createElement("main",null,r.a.createElement(z,{onRun:i}),l&&"result"in l?r.a.createElement(ne,{data:ae(l.result),nodeComponent:ce,linkComponent:re}):null)},ue=function(e,t){return fetch("".concat(e,"/api/v2/write"),{method:"POST",body:t})},oe=[{label:"Write",value:"write"},{label:"Delete",value:"delete"}],ie=function(e){var t=e.serverURL,n=Object(a.useState)(oe[0].value),c=Object(u.a)(n,2),l=c[0],o=c[1],i=x(),s=Object(u.a)(i,2),f=s[0],m=s[1],d=Object(a.useCallback)(function(){if(m){var e=m.getValue();switch(l){case"write":return void ue(t,e);case"delete":return void function(e,t){fetch("".concat(e,"/api/v2/delete"),{method:"POST",body:t})}(t,e);default:throw new Error("Unexpected mode ".concat(l))}}},[t,m,l]),p=Object(a.useCallback)(function(e){o(e.target.value)},[o]),v=Object(a.useRef)(null),b=Object(a.useCallback)(function(){var e=v.current;e&&e.click()},[v]),g=Object(a.useCallback)(function(e){var n=!0,a=!1,r=void 0;try{for(var c,l=function(){var e=c.value;ue(t,e).then(function(){console.log("Uploaded ".concat(e.name))})},u=e.currentTarget.files[Symbol.iterator]();!(n=(c=u.next()).done);n=!0)l()}catch(o){a=!0,r=o}finally{try{n||null==u.return||u.return()}finally{if(a)throw r}}},[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"file",ref:v,style:{display:"none"},onChange:g}),r.a.createElement("main",null,r.a.createElement(E.a,{use:"headline6"},"Write"),r.a.createElement(O.a,{editorDidMount:f,language:"nquads",options:{minimap:{enabled:!1}}}),r.a.createElement("div",{className:"actions"},r.a.createElement(k,{onClick:d}),r.a.createElement(j.a,{outlined:!0,options:oe,value:l,onChange:p}),r.a.createElement(w.a,{label:"Upload file",onClick:b}))))},se=n(18),fe=(n(82),n(39)),me=n.n(fe),de=(n(83),"http://localhost:64210");var pe=function(){if(void 0===de)throw new Error("SERVER_URL environment variable must be provided");var e=Object(a.useState)("query"),t=Object(u.a)(e,2),n=t[0],c=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement(se.a,null,r.a.createElement(se.c,null,r.a.createElement(se.d,null,r.a.createElement("img",{className:"Logo",src:me.a,alt:"logo"}),"Cayley")),r.a.createElement(se.b,null,r.a.createElement(W.a,null,r.a.createElement(J.d,{onClick:function(){return c("query")},activated:"query"===n},"Query"),r.a.createElement(J.d,{activated:"queryShape"===n,onClick:function(){return c("queryShape")}},"Query Shape"),r.a.createElement(J.d,{activated:"visualize"===n,onClick:function(){return c("visualize")}},"Visualize"),r.a.createElement(J.d,{activated:"write"===n,onClick:function(){return c("write")}},"Write")))),"query"===n&&r.a.createElement(G,{serverURL:de}),"queryShape"===n&&r.a.createElement(Y,{serverURL:de}),"visualize"===n&&r.a.createElement(le,{serverURL:de}),"write"===n&&r.a.createElement(ie,{serverURL:de}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[47,1,2]]]);
//# sourceMappingURL=main.84d3ab8c.chunk.js.map